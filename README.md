# 📊 売上データ集計・月次グラフツール

## 📌 プロジェクト概要

このプロジェクトは、CSV 形式の売上データを読み込み、以下の処理を行う Python スクリプトです：

- 月ごとの売上・手数料を集計  
- 店舗ごとのデータを Excel に分割保存  
- 3 店舗ずつのグループで月次売上グラフを描画

---

## 🗂 入力 CSV の形式（必須）

処理対象となる CSV は、以下の列を含む必要があります：

| 列名     | 説明                             | 例                   |
|----------|----------------------------------|----------------------|
| `店舗名` | 各売上データの店舗識別           | `A店`, `B店`, `C店`  |
| `日付`   | 売上発生日（yyyy-mm-dd 形式）    | `2025-01-05`         |
| `金額`   | 売上金額                         | `12000`              |
| `手数料` | 手数料                           | `600`                |

※ 列名が完全一致していることを確認してください

---

## 🛠️ セットアップ方法（事前準備）

以下の Python ライブラリが必要です：

```bash
pip install pandas openpyxl matplotlib
```

---

## ▶️ 使い方（実行手順）

1. このスクリプトファイル（例：`main.py`）を用意します  
2. 同じフォルダ（または任意のフォルダ）に売上データの CSV を置きます  
3. ターミナル/コマンドプロンプトから次のように実行：

```bash
python main.py
```

実行すると、次の入力が求められます：

```
csvファイルが入ってるフォルダ名を入力して:
csvファイルの名前を “ファイル名.csv” という形で入力して:
```

### ✨ 入力例

```
csvファイルが入ってるフォルダ名を入力して: sales_data
csvファイルの名前を “ファイル名.csv” という形で入力して: store_sales.csv
```

---

## 📂 出力例（実行後）

| 出力ファイル名            | 内容 |
|---------------------------|------|
| `newtype.csv`             | 月ごとの集計データ |
| `new_excel.xlsx`          | 店舗ごとに分割された Excel シート |
| グラフ描画（表示のみ）   | 3店舗ごとの月次売上グラフ |

- グラフは自動で 3 店舗ずつのグループに分けて表示されます  
- 各グラフは折れ線で表示され、月ごとの売上推移が見られます

---

## 📈 処理の仕組み（何をしているか）

1. CSV を pandas で読み込む  
2. 各店舗に “店舗番号” を自動で付与  
3. 日付から “月” を抽出  
4. 月ごとの売上総額と手数料総額を計算  
5. 月次集計結果を `newtype.csv` として保存  
6. 元データと集計結果を Excel に出力（店舗別シート）  
7. 3 店舗ずつのグループに分けて月次売上グラフを描画

---

## 💡 改善例（Optional）

以下のような機能追加を考えています：


- Web UI で CSV をアップロードできるようにする  
- グラフを画像（PNG/SVG/PDF）として保存  


---

## 📄 ライセンス

This project uses the MIT License.


